<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÆ Your Collections - VideoShop</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <div class="hamburger-menu" id="hamburger-menu">
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
      <!-- Monthly Leaderboard - Fixed Position Top Right -->
      <div class="monthly-leaderboard" style="position: fixed; top: 80px; right: 20px; width: 320px; z-index: 1000; background: rgba(0, 0, 0, 0.9); border: 2px solid var(--accent-color); border-radius: 15px; padding: 15px; backdrop-filter: blur(10px); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);">
        <div style="text-align: center; margin-bottom: 12px;">
          <h3 style="color: var(--accent-color); margin: 0; font-size: 1.1rem; display: flex; align-items: center; justify-content: center; gap: 8px;">
            üèÜ Monthly Champions
            <button onclick="toggleLeaderboard()" style="background: none; border: none; color: var(--accent-color); font-size: 1rem; cursor: pointer; padding: 2px;">üìç</button>
          </h3>
          <div style="font-size: 0.8rem; color: #FF6B6B; font-weight: bold;">
            üóìÔ∏è <span id="monthTimer">00:00:00:00</span>
          </div>
          <div style="font-size: 0.7rem; color: var(--accent-color);">
            üéÅ Prize: $100 Gift Card!
          </div>
        </div>
        
        <div id="leaderboardContent" style="max-height: 300px; overflow-y: auto;">
          <!-- Top 3 Compact -->
          <div id="leaderSlot1" style="display: flex; align-items: center; gap: 8px; padding: 8px; margin-bottom: 6px; background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1)); border-radius: 8px; border: 2px solid #FFD700;">
            <div style="font-size: 1.2rem;">ü•á</div>
            <div style="flex: 1; font-size: 0.85rem;">
              <div id="leader1Name" style="font-weight: bold; color: #FFD700;">No Champion Yet</div>
              <div id="leader1Score" style="color: var(--text-color); font-size: 0.75rem;">0 pts</div>
            </div>
          </div>
          
          <div id="leaderSlot2" style="display: flex; align-items: center; gap: 8px; padding: 6px; margin-bottom: 4px; background: rgba(192, 192, 192, 0.1); border-radius: 6px;">
            <div style="font-size: 1rem;">ü•à</div>
            <div style="flex: 1; font-size: 0.8rem;">
              <div id="leader2Name" style="font-weight: bold;">Runner-up</div>
              <div id="leader2Score" style="color: var(--text-color); font-size: 0.7rem;">0 pts</div>
            </div>
          </div>
          
          <div id="leaderSlot3" style="display: flex; align-items: center; gap: 8px; padding: 6px; margin-bottom: 8px; background: rgba(205, 127, 50, 0.1); border-radius: 6px;">
            <div style="font-size: 1rem;">ü•â</div>
            <div style="flex: 1; font-size: 0.8rem;">
              <div id="leader3Name" style="font-weight: bold;">Third Place</div>
              <div id="leader3Score" style="color: var(--text-color); font-size: 0.7rem;">0 pts</div>
            </div>
          </div>
          
          <!-- Remaining slots 4-10 compact -->
          <div id="leaderSlot4" style="display: flex; align-items: center; gap: 8px; padding: 4px; margin-bottom: 2px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">4</div>
            <div style="flex: 1;">
              <span id="leader4Name" style="font-weight: bold;">4th</span>
              <span id="leader4Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
          
          <div id="leaderSlot5" style="display: flex; align-items: center; gap: 8px; padding: 4px; margin-bottom: 2px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">5</div>
            <div style="flex: 1;">
              <span id="leader5Name" style="font-weight: bold;">5th</span>
              <span id="leader5Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
          
          <div id="leaderSlot6" style="display: flex; align-items: center; gap: 8px; padding: 4px; margin-bottom: 2px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">6</div>
            <div style="flex: 1;">
              <span id="leader6Name" style="font-weight: bold;">6th</span>
              <span id="leader6Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
          
          <div id="leaderSlot7" style="display: flex; align-items: center; gap: 8px; padding: 4px; margin-bottom: 2px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">7</div>
            <div style="flex: 1;">
              <span id="leader7Name" style="font-weight: bold;">7th</span>
              <span id="leader7Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
          
          <div id="leaderSlot8" style="display: flex; align-items: center; gap: 8px; padding: 4px; margin-bottom: 2px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">8</div>
            <div style="flex: 1;">
              <span id="leader8Name" style="font-weight: bold;">8th</span>
              <span id="leader8Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
          
          <div id="leaderSlot9" style="display: flex; align-items: center; gap: 8px; padding: 4px; margin-bottom: 2px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">9</div>
            <div style="flex: 1;">
              <span id="leader9Name" style="font-weight: bold;">9th</span>
              <span id="leader9Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
          
          <div id="leaderSlot10" style="display: flex; align-items: center; gap: 8px; padding: 4px; font-size: 0.75rem;">
            <div style="min-width: 20px; text-align: center; font-weight: bold;">10</div>
            <div style="flex: 1;">
              <span id="leader10Name" style="font-weight: bold;">10th</span>
              <span id="leader10Score" style="color: var(--text-color);"> - 0</span>
            </div>
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 8px; padding: 6px; background: rgba(255, 255, 255, 0.05); border-radius: 6px; font-size: 0.7rem; color: var(--text-color);">
          üéÆ Sign in & play to compete!
        </div>
      </div>

    </div>
    <a href="/" class="logo">Video<span>Shop</span></a>
    <div class="search-bar">
      <input type="text" placeholder="Search collections">
      <button>üîç</button>
    </div>
    <div class="user-actions">
      <a href="#" class="sign-in" onclick="openModal('login-modal')">Sign In</a>
    </div>
  </header>

  <div class="container">
    <nav class="sidebar">
      <a href="/" class="sidebar-item">
        <span class="sidebar-icon">üè†</span>
        <span class="sidebar-text">Home</span>
      </a>
      <a href="/trending" class="sidebar-item">
        <span class="sidebar-icon">üî•</span>
        <span class="sidebar-text">Trending</span>
      </a>
      <a href="/subscriptions" class="sidebar-item">
        <span class="sidebar-icon">üìã</span>
        <span class="sidebar-text">Subscriptions</span>
      </a>
      <a href="/shop" class="sidebar-item">
        <span class="sidebar-icon">üõí</span>
        <span class="sidebar-text">Shop</span>
      </a>
      <a href="/library" class="sidebar-item active">
        <span class="sidebar-icon">üìö</span>
        <span class="sidebar-text">Library</span>
      </a>
      <a href="/history" class="sidebar-item">
        <span class="sidebar-icon">‚è±Ô∏è</span>
        <span class="sidebar-text">History</span>
      </a>
      <a href="/your-videos" class="sidebar-item">
        <span class="sidebar-icon">‚èØÔ∏è</span>
        <span class="sidebar-text">Your Videos</span>
      </a>
      <a href="/watch-later" class="sidebar-item">
        <span class="sidebar-icon">‚è∞</span>
        <span class="sidebar-text">Watch Later</span>
      </a>
      <a href="/liked-videos" class="sidebar-item">
        <span class="sidebar-icon">üëç</span>
        <span class="sidebar-text">Liked Videos</span>
      </a>
    </nav>

    <div class="main-content">
      <!-- Simple Game Header -->
      <div class="subscriptions-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; padding: 32px; background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(139, 111, 71, 0.05)); border-radius: 16px; border: 1px solid rgba(212, 175, 55, 0.2); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);">
        <div class="subscriptions-title-section">
          <h1 class="subscriptions-title" style="font-size: 2.8rem; margin-bottom: 12px; background: linear-gradient(135deg, var(--accent-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-shadow: 0 0 20px rgba(212, 175, 55, 0.3);">üéÆ Simple Kirby Wings</h1>
          <p class="subscriptions-subtitle" style="color: var(--text-color); font-size: 1.2rem; margin-top: 8px;">Flap to fly! Collect üéÅ presents, avoid ‚ùå X's!</p>
        </div>
        <div class="subscriptions-stats" id="gaming-stats" style="display: flex; gap: 32px;">
          <div class="stat-item" style="text-align: center;">
            <span class="stat-number" id="score-display" style="display: block; font-size: 2rem; font-weight: 700; color: var(--accent-color); text-shadow: 0 0 10px rgba(212, 175, 55, 0.4);">0</span>
            <span class="stat-label" style="font-size: 1rem; color: var(--text-color);">Score</span>
          </div>
          <div class="stat-item" style="text-align: center;">
            <span class="stat-number" id="speed-display" style="display: block; font-size: 2rem; font-weight: 700; color: var(--accent-color); text-shadow: 0 0 10px rgba(212, 175, 55, 0.4);">1.0x</span>
            <span class="stat-label" style="font-size: 1rem; color: var(--text-color);">Speed</span>
          </div>
          <div class="stat-item" style="text-align: center;">
            <span class="stat-number" id="best-score-display" style="display: block; font-size: 2rem; font-weight: 700; color: var(--accent-color); text-shadow: 0 0 10px rgba(212, 175, 55, 0.4);">0</span>
            <span class="stat-label" style="font-size: 1rem; color: var(--text-color);">Best</span>
          </div>
        </div>
      </div>

      <!-- Simple Instructions -->
      <div class="quick-subscribe-section" style="margin-bottom: 40px;">
        <div class="section-header" style="margin-bottom: 24px;">
          <h2 class="section-title" style="font-size: 2rem; margin-bottom: 8px; color: var(--accent-color); text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);">üìñ Super Simple Rules</h2>
          <p class="section-subtitle" style="color: var(--text-color); font-size: 1.1rem;">Just two things to remember!</p>
        </div>
        
        <div style="display: flex; justify-content: center; gap: 40px; margin: 20px 0;">
          <div style="text-align: center; padding: 20px; background: rgba(76, 175, 80, 0.2); border-radius: 15px; border: 2px solid #4CAF50;">
            <div style="font-size: 4rem; margin-bottom: 10px;">üéÅ</div>
            <div style="color: #4CAF50; font-weight: bold; font-size: 1.3rem;">COLLECT = GOOD!</div>
            <div style="color: var(--text-color); font-size: 1rem;">Present boxes give points</div>
          </div>
          <div style="text-align: center; padding: 20px; background: rgba(244, 67, 54, 0.2); border-radius: 15px; border: 2px solid #f44336;">
            <div style="font-size: 4rem; margin-bottom: 10px;">‚ùå</div>
            <div style="color: #f44336; font-weight: bold; font-size: 1.3rem;">AVOID = BAD!</div>
            <div style="color: var(--text-color); font-size: 1rem;">X marks end the game</div>
          </div>
        </div>
      </div>

      <!-- Simple Game -->
      <div class="quick-subscribe-section" style="margin-bottom: 40px;">
        <div class="section-header" style="margin-bottom: 24px;">
          <h2 class="section-title" style="font-size: 2rem; margin-bottom: 8px; color: var(--accent-color); text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);">üåü Kirby Wings Game</h2>
          <p class="section-subtitle" style="color: var(--text-color); font-size: 1.1rem;">Clean, simple, fun!</p>
        </div>
        
        <div class="preferences-card" style="padding: 24px; background: rgba(255, 255, 255, 0.05); border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.1);">
          <div style="position: relative; background: linear-gradient(135deg, #87CEEB 0%, #87CEFA 50%, #98FB98 100%); border-radius: 10px; overflow: hidden; margin-bottom: 20px; border: 3px solid var(--accent-color); box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);">
            <canvas id="gameCanvas" width="800" height="500" style="display: block; width: 100%; height: 500px; border-radius: 8px;"></canvas>
            <div style="position: absolute; top: 15px; left: 15px; right: 15px; display: flex; justify-content: space-between; color: #000; font-weight: bold; z-index: 10; background: rgba(255,255,255,0.9); padding: 10px; border-radius: 8px; border: 2px solid var(--accent-color);">
              <div style="display: flex; gap: 20px;">
                <div>üéÅ Score: <span id="gameScore" style="color: #4CAF50;">0</span></div>
                <div>‚ö° Speed: <span id="gameSpeed" style="color: #FF9800;">1.0x</span></div>
              </div>
              <div id="gameStatus" style="color: var(--accent-color); font-size: 1.1rem;">Press SPACE or TAP to flap!</div>
            </div>
          </div>
          
          <div style="display: flex; gap: 15px; justify-content: center; margin-bottom: 20px;">
            <button class="subscribe-btn game-btn" id="startBtn" onclick="startGame()" style="padding: 15px 30px; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1rem;">üöÄ START</button>
            <button class="subscribe-btn game-btn" onclick="pauseGame()" id="pauseBtn" style="padding: 15px 30px; background: linear-gradient(135deg, #FF9800, #f57f17); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1rem;">‚è∏Ô∏è PAUSE</button>
            <button class="subscribe-btn game-btn" onclick="resetGame()" style="padding: 15px 30px; background: linear-gradient(135deg, #f44336, #d32f2f); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1rem;">üîÑ RESET</button>
          </div>
          
          <!-- Mobile Controls -->
          <div id="mobileControls" style="display: flex; justify-content: center; gap: 20px; margin-bottom: 15px;">
            <button class="mobile-control-btn" id="flapBtn" style="padding: 20px 40px; background: linear-gradient(135deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 15px; font-size: 1.5rem; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);">ü™∂ FLAP</button>
          </div>
          
          <div style="text-align: center; color: var(--text-color); line-height: 1.8;">
            <p><strong style="color: var(--accent-color);">Controls:</strong> SPACEBAR or TAP to flap your wings!</p>
            <p><strong style="color: var(--accent-color);">Goal:</strong> Collect üéÅ presents for points, avoid ‚ùå X marks!</p>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="sidebar-overlay"></div>

  <!-- Login Modal -->
  <div id="login-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Sign In</h3>
        <button class="close-modal" onclick="closeModal('login-modal')">√ó</button>
      </div>
      <form class="modal-form" id="login-form">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" required>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" required>
        </div>
        <button type="submit" class="form-submit">Sign In</button>
        <div class="form-switch">
          Don't have an account? <a href="#" onclick="switchModal('login-modal', 'signup-modal')">Sign Up</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Signup Modal -->
  <div id="signup-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Create Account</h3>
        <button class="close-modal" onclick="closeModal('signup-modal')">√ó</button>
      </div>
      <form class="modal-form" id="signup-form">
        <div class="form-group">
          <label for="signup-name">Full Name</label>
          <input type="text" id="signup-name" required>
        </div>
        <div class="form-group">
          <label for="signup-email">Email</label>
          <input type="email" id="signup-email" required>
        </div>
        <div class="form-group">
          <label for="signup-password">Password</label>
          <input type="password" id="signup-password" required minlength="6">
        </div>
        <div class="form-group">
          <label for="signup-confirm">Confirm Password</label>
          <input type="password" id="signup-confirm" required minlength="6">
        </div>
        <button type="submit" class="form-submit">Create Account</button>
        <div class="form-switch">
          Already have an account? <a href="#" onclick="switchModal('signup-modal', 'login-modal')">Sign In</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="/js/main.js"></script>
  <script src="/js/subtle-effect.js"></script>
  
  <script>
    // SIMPLE KIRBY FLAPPY GAME - FRESH START! üéÆ
    
    // Simple game variables
    let gameRunning = false;
    let score = 0;
    let gameSpeed = 2;
    let bestScore = 0;
    let currentUser = null; // Track logged in user
    
    // Monthly leaderboard system
    let monthlyLeaderboard = [];
    
    // Simple player
    let player = {
      x: 100,
      y: 200,
      width: 40,
      height: 40,
      velocityY: 0,
      gravity: 0.4,
      flapPower: -8  // Tiny bit bigger jump as requested
    };
    
    // Simple arrays
    let presents = [];  // Good items
    let xMarks = [];    // Bad items
    let lastSpawnTime = 0;
    
    // Canvas
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      initGame();
      setupControls();
      loadBestScore();
      loadMonthlyLeaderboard();
      updateMonthTimer();
      setInterval(updateMonthTimer, 1000); // Update timer every second
    });
    
    function initGame() {
      canvas.width = 800;
      canvas.height = 500;
      
      drawBackground();
      drawPlayer();
      
      // Simple welcome message
      ctx.fillStyle = '#000';
      ctx.font = 'bold 24px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('üéÆ Simple Kirby Wings! üéÆ', canvas.width/2, 200);
      ctx.font = '18px Arial';
      ctx.fillText('Press SPACE or TAP to flap!', canvas.width/2, 240);
      ctx.fillText('Collect üéÅ presents, avoid ‚ùå X marks!', canvas.width/2, 270);
      ctx.textAlign = 'left';
    }
    
    function startGame() {
      if (gameRunning) return;
      
      gameRunning = true;
      score = 0;
      gameSpeed = 2;
      
      // Reset player
      player.x = 100;
      player.y = 200;
      player.velocityY = 0;
      
      // Clear arrays
      presents = [];
      xMarks = [];
      lastSpawnTime = 0;
      
      document.getElementById('startBtn').disabled = true;
      document.getElementById('gameStatus').textContent = 'Flying! Keep flapping!';
      
      gameLoop();
    }
    
    function pauseGame() {
      gameRunning = !gameRunning;
      const pauseBtn = document.getElementById('pauseBtn');
      if (gameRunning) {
        pauseBtn.textContent = '‚è∏Ô∏è PAUSE';
        document.getElementById('gameStatus').textContent = 'Flying! Keep flapping!';
        gameLoop();
      } else {
        pauseBtn.textContent = '‚ñ∂Ô∏è RESUME';
        document.getElementById('gameStatus').textContent = 'Game Paused';
      }
    }
    
    function resetGame() {
      gameRunning = false;
      score = 0;
      gameSpeed = 2;
      
      player.x = 100;
      player.y = 200;
      player.velocityY = 0;
      
      presents = [];
      xMarks = [];
      
      document.getElementById('startBtn').disabled = false;
      document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è PAUSE';
      document.getElementById('gameStatus').textContent = 'Press SPACE or TAP to flap!';
      
      updateUI();
      initGame();
    }
    
    function gameLoop() {
      if (!gameRunning) return;
      
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Draw everything
      drawBackground();
      updatePlayer();
      spawnItems();
      updatePresents();
      updateXMarks();
      drawPlayer();
      
      // Check collisions
      checkCollisions();
      
      // Check if fell off screen
      if (player.y > canvas.height) {
        gameOver();
        return;
      }
      
      // Increase score and speed gradually
      score += 1;
      gameSpeed = 2 + (score / 500); // Gradual speed increase
      
      updateUI();
      requestAnimationFrame(gameLoop);
    }
    
    function drawBackground() {
      // Simple sky gradient
      const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
      gradient.addColorStop(0, '#87CEEB');
      gradient.addColorStop(1, '#E0F6FF');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }
    
    function updatePlayer() {
      // Simple physics
      player.velocityY += player.gravity;
      player.y += player.velocityY;
      
      // Keep in bounds (top only)
      if (player.y < 0) {
        player.y = 0;
        player.velocityY = 0;
      }
    }
    
    function drawPlayer() {
      // Simple Kirby character
      ctx.fillStyle = '#FF69B4';
      ctx.beginPath();
      ctx.arc(player.x + 20, player.y + 20, 18, 0, Math.PI * 2);
      ctx.fill();
      
      // Simple eyes
      ctx.fillStyle = '#000';
      ctx.fillRect(player.x + 12, player.y + 14, 4, 4);
      ctx.fillRect(player.x + 24, player.y + 14, 4, 4);
      
      // Simple mouth
      ctx.fillStyle = '#8B0000';
      ctx.beginPath();
      ctx.arc(player.x + 20, player.y + 24, 4, 0, Math.PI);
      ctx.fill();
    }
    
    function spawnItems() {
      const currentTime = Date.now();
      
      // Spawn every 1.5 seconds, adjusted by speed
      if (currentTime - lastSpawnTime > 1500 / gameSpeed) {
        
        // 70% chance for present, 30% chance for X
        if (Math.random() < 0.7) {
          presents.push({
            x: canvas.width,
            y: 50 + Math.random() * (canvas.height - 150),
            width: 30,
            height: 30
          });
        } else {
          xMarks.push({
            x: canvas.width,
            y: 50 + Math.random() * (canvas.height - 150),
            width: 30,
            height: 30
          });
        }
        
        lastSpawnTime = currentTime;
      }
    }
    
    function updatePresents() {
      presents = presents.filter(present => {
        present.x -= gameSpeed;
        
        // Draw present
        ctx.font = '30px Arial';
        ctx.fillText('üéÅ', present.x, present.y + 25);
        
        return present.x > -present.width;
      });
    }
    
    function updateXMarks() {
      xMarks = xMarks.filter(x => {
        x.x -= gameSpeed;
        
        // Draw X mark
        ctx.font = '30px Arial';
        ctx.fillText('‚ùå', x.x, x.y + 25);
        
        return x.x > -x.width;
      });
    }
    
    function checkCollisions() {
      // Check presents
      presents.forEach((present, index) => {
        if (isColliding(player, present)) {
          presents.splice(index, 1);
          score += 100;
          
          // Visual feedback
          canvas.style.filter = 'brightness(1.3)';
          setTimeout(() => {
            canvas.style.filter = 'brightness(1)';
          }, 100);
        }
      });
      
      // Check X marks
      xMarks.forEach((x, index) => {
        if (isColliding(player, x)) {
          xMarks.splice(index, 1);
          gameOver();
        }
      });
    }
    
    function isColliding(rect1, rect2) {
      return rect1.x < rect2.x + rect2.width &&
             rect1.x + rect1.width > rect2.x &&
             rect1.y < rect2.y + rect2.height &&
             rect1.y + rect1.height > rect2.y;
    }
    
    function gameOver() {
      gameRunning = false;
      
      // Submit score to monthly leaderboard if user is logged in
      if (currentUser && score > 0) {
        submitScoreToLeaderboard(currentUser.name, score);
      }
      
      if (score > bestScore) {
        bestScore = score;
        saveBestScore();
        document.getElementById('gameStatus').textContent = `NEW BEST SCORE: ${score}!`;
      } else {
        document.getElementById('gameStatus').textContent = `Game Over! Score: ${score}`;
      }
      
      document.getElementById('startBtn').disabled = false;
      document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è PAUSE';
      
      updateUI();
    }
    
    // MONTHLY LEADERBOARD SYSTEM
    function submitScoreToLeaderboard(playerName, playerScore) {
      // Get current month key
      const now = new Date();
      const monthKey = `${now.getFullYear()}-${now.getMonth()}`;
      
      // Load monthly leaderboard
      let monthlyData = JSON.parse(localStorage.getItem('monthlyLeaderboard_' + monthKey) || '[]');
      
      // Find existing player or add new one
      let existingPlayer = monthlyData.find(p => p.name === playerName);
      
      if (existingPlayer) {
        // Update if this is a better score
        if (playerScore > existingPlayer.score) {
          existingPlayer.score = playerScore;
          existingPlayer.date = now.toISOString();
        }
      } else {
        // Add new player
        monthlyData.push({
          name: playerName,
          score: playerScore,
          date: now.toISOString()
        });
      }
      
      // Sort by score (highest first) and keep top 10
      monthlyData.sort((a, b) => b.score - a.score);
      monthlyData = monthlyData.slice(0, 10);
      
      // Save back to localStorage
      localStorage.setItem('monthlyLeaderboard_' + monthKey, JSON.stringify(monthlyData));
      
      // Update display
      updateLeaderboardDisplay(monthlyData);
    }
    
    function loadMonthlyLeaderboard() {
      const now = new Date();
      const monthKey = `${now.getFullYear()}-${now.getMonth()}`;
      const monthlyData = JSON.parse(localStorage.getItem('monthlyLeaderboard_' + monthKey) || '[]');
      updateLeaderboardDisplay(monthlyData);
    }
    
    function updateLeaderboardDisplay(leaderboardData) {
      // Update top 10 slots with compact format
      for (let i = 1; i <= 10; i++) {
        const player = leaderboardData[i - 1];
        const nameElement = document.getElementById(`leader${i}Name`);
        const scoreElement = document.getElementById(`leader${i}Score`);
        
        if (player) {
          nameElement.textContent = player.name;
          if (i <= 3) {
            // Top 3 get more detailed display
            scoreElement.textContent = `${player.score.toLocaleString()} pts`;
          } else {
            // 4-10 get compact display
            scoreElement.textContent = ` - ${player.score.toLocaleString()}`;
          }
        } else {
          nameElement.textContent = i <= 3 ? getOrdinal(i) + ' Place' : getOrdinal(i);
          scoreElement.textContent = i <= 3 ? '0 pts' : ' - 0';
        }
      }
    }
    
    // Add toggle function for leaderboard
    function toggleLeaderboard() {
      const leaderboard = document.querySelector('.monthly-leaderboard');
      const content = document.getElementById('leaderboardContent');
      
      if (content.style.display === 'none') {
        content.style.display = 'block';
        leaderboard.style.height = 'auto';
      } else {
        content.style.display = 'none';
        leaderboard.style.height = '60px';
      }
    }
    
    function getOrdinal(number) {
      const ordinals = ['', '1st', '2nd', '3rd', '4th', '5th', '6th', '7th', '8th', '9th', '10th'];
      return ordinals[number] || `${number}th`;
    }
    
    function updateMonthTimer() {
      const now = new Date();
      const nextMonth = new Date(now.getFullYear(), now.getMonth() + 1, 1);
      const timeLeft = nextMonth - now;
      
      if (timeLeft <= 0) {
        // Month ended - could trigger winner announcement here
        document.getElementById('monthTimer').textContent = '00:00:00:00';
        return;
      }
      
      const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
      const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
      
      document.getElementById('monthTimer').textContent = 
        `${days.toString().padStart(2, '0')}:${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    
    function updateUI() {
      document.getElementById('gameScore').textContent = score;
      document.getElementById('gameSpeed').textContent = gameSpeed.toFixed(1) + 'x';
      document.getElementById('score-display').textContent = score;
      document.getElementById('speed-display').textContent = gameSpeed.toFixed(1) + 'x';
      document.getElementById('best-score-display').textContent = bestScore;
    }
    
    function flap() {
      if (gameRunning) {
        player.velocityY = player.flapPower;
      }
    }
    
    function setupControls() {
      // Keyboard
      document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
          e.preventDefault();
          flap();
        }
      });
      
      // Touch
      canvas.addEventListener('click', flap);
      canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        flap();
      });
      
      // Mobile button
      document.getElementById('flapBtn').addEventListener('click', flap);
    }
    
    function saveBestScore() {
      localStorage.setItem('kirbyBestScore', bestScore);
    }
    
    function loadBestScore() {
      const saved = localStorage.getItem('kirbyBestScore');
      if (saved) {
        bestScore = parseInt(saved);
        updateUI();
      }
    }
    
    // Modal functions - WORKING SIGNIN!
    function openModal(modalId) {
      document.getElementById(modalId).style.display = 'flex';
      document.body.classList.add('modal-open');
    }
    
    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
      document.body.classList.remove('modal-open');
    }
    
    function switchModal(closeId, openId) {
      closeModal(closeId);
      openModal(openId);
    }
    
    // Handle login form submission
    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      
      // Simple validation
      if (email && password) {
        // Set current user
        currentUser = {
          name: email.split('@')[0],
          email: email
        };
        
        // Show success message
        alert('Login successful! Welcome to Kirby Wings! Your scores now count for the monthly leaderboard!');
        closeModal('login-modal');
        
        // Update sign-in button to show user is logged in
        document.querySelector('.sign-in').textContent = 'Welcome, ' + currentUser.name + '!';
        document.querySelector('.sign-in').onclick = null;
        document.querySelector('.sign-in').style.color = '#4CAF50';
        
        // Clear form
        document.getElementById('login-form').reset();
      } else {
        alert('Please enter both email and password');
      }
    });
    
    // Handle signup form submission
    document.getElementById('signup-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('signup-name').value;
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;
      const confirmPassword = document.getElementById('signup-confirm').value;
      
      // Simple validation
      if (name && email && password && confirmPassword) {
        if (password === confirmPassword) {
          // Set current user
          currentUser = {
            name: name,
            email: email
          };
          
          alert('Account created successfully! Welcome to Kirby Wings! Your scores now count for the monthly leaderboard!');
          closeModal('signup-modal');
          
          // Update sign-in button to show user is logged in
          document.querySelector('.sign-in').textContent = 'Welcome, ' + currentUser.name + '!';
          document.querySelector('.sign-in').onclick = null;
          document.querySelector('.sign-in').style.color = '#4CAF50';
          
          // Clear form
          document.getElementById('signup-form').reset();
        } else {
          alert('Passwords do not match');
        }
      } else {
        alert('Please fill in all fields');
      }
    });
    
    // Close modal when clicking outside
    window.onclick = function(event) {
      const modals = document.getElementsByClassName('modal');
      for (let i = 0; i < modals.length; i++) {
        if (event.target === modals[i]) {
          closeModal(modals[i].id);
        }
      }
    };
    
  </script>

<style>
/* Simple game styles */
.modal {
  display: none;
  position: fixed;
  z-index: 10000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: var(--bg-color);
  padding: 30px;
  border-radius: 15px;
  width: 90%;
  max-width: 400px;
  border: 2px solid var(--accent-color);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.modal-title {
  color: var(--accent-color);
  margin: 0;
  font-size: 1.5rem;
}

.close-modal {
  background: none;
  border: none;
  color: var(--text-color);
  font-size: 2rem;
  cursor: pointer;
  padding: 0;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.close-modal:hover {
  color: var(--accent-color);
}

.modal-form {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.form-group label {
  color: var(--text-color);
  font-weight: 500;
}

.form-group input {
  padding: 12px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.1);
  color: var(--text-color);
  border-radius: 8px;
  font-size: 1rem;
}

.form-group input:focus {
  outline: none;
  border-color: var(--accent-color);
  box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
}

.form-submit {
  background: linear-gradient(135deg, var(--accent-color), var(--secondary-color));
  color: #000;
  border: none;
  padding: 15px;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.3s ease;
}

.form-submit:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
}

.form-switch {
  text-align: center;
  color: var(--text-color);
  margin-top: 15px;
}

.form-switch a {
  color: var(--accent-color);
  text-decoration: none;
  font-weight: bold;
}

.form-switch a:hover {
  text-decoration: underline;
}

body.modal-open {
  overflow: hidden;
}

#gameCanvas {
  border: 3px solid var(--accent-color);
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
  width: 100%;
  max-width: 800px;
  height: 500px;
}

.game-btn {
  transition: all 0.3s ease;
  font-weight: bold;
  text-transform: uppercase;
}

.game-btn:hover {
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.mobile-control-btn {
  transition: all 0.3s ease;
  user-select: none;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.mobile-control-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
}

.subscription-card {
  transition: all 0.3s ease;
}

.subscription-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

@media (max-width: 768px) {
  .subscriptions-header {
    flex-direction: column;
    gap: 20px;
    text-align: center;
    padding: 24px;
  }

  .subscriptions-stats {
    gap: 20px;
    justify-content: center;
  }

  .subscriptions-title {
    font-size: 2.2rem;
  }

  #gameCanvas {
    height: 400px;
  }

  .game-btn {
    width: 100%;
    margin-bottom: 8px;
  }
}

@media (max-width: 480px) {
  .subscriptions-title {
    font-size: 1.8rem;
  }

  #gameCanvas {
    height: 300px;
  }

  .mobile-control-btn {
    padding: 15px 30px;
    font-size: 1.3rem;
  }
}
</style>
</body>
</html>
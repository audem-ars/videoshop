<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VideoShop</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- Ambient Background - ABSOLUTELY PURE BLACK -->
  <div class="ambient-background"></div>
  
  <!-- Header -->
  <header>
    <div class="hamburger-menu" id="hamburger-menu">
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
    </div>
    <a href="/" class="logo">Video<span>Shop</span></a>
    
    <div class="search-bar">
      <input type="text" placeholder="Search">
      <button>🔍</button>
    </div>
    
    <div class="user-actions">
      <button id="upload-btn">Upload</button>
      <a href="#" class="sign-in" onclick="openModal('login-modal')">Sign In</a>
    </div>
  </header>
  
  <!-- Main Container -->
  <div class="container">
    <!-- Sidebar -->
    <nav class="sidebar">
      <a href="/" class="sidebar-item active">
        <span class="sidebar-icon">🏠</span>
        <span class="sidebar-text">Home</span>
      </a>
      <a href="/trending" class="sidebar-item">
        <span class="sidebar-icon">🔥</span>
        <span class="sidebar-text">Trending</span>
      </a>
      <a href="/subscriptions" class="sidebar-item">
        <span class="sidebar-icon">📋</span>
        <span class="sidebar-text">Subscriptions</span>
      </a>
      <a href="/shop" class="sidebar-item">
        <span class="sidebar-icon">🛒</span>
        <span class="sidebar-text">Shop</span>
      </a>
      <a href="/library" class="sidebar-item">
        <span class="sidebar-icon">📚</span>
        <span class="sidebar-text">Library</span>
      </a>
      <a href="/history" class="sidebar-item">
        <span class="sidebar-icon">⏱️</span>
        <span class="sidebar-text">History</span>
      </a>
      <a href="/your-videos" class="sidebar-item">
        <span class="sidebar-icon">⏯️</span>
        <span class="sidebar-text">Your Videos</span>
      </a>
      <a href="/watch-later" class="sidebar-item">
        <span class="sidebar-icon">⏰</span>
        <span class="sidebar-text">Watch Later</span>
      </a>
      <a href="/liked-videos" class="sidebar-item">
        <span class="sidebar-icon">👍</span>
        <span class="sidebar-text">Liked Videos</span>
      </a>
    </nav>
    
    <!-- Main Content -->
    <div class="main-content">
      <!-- Featured Video -->
      <div class="featured-video">
        <div class="video-container">
          <div class="video-placeholder">
            <!-- Play button added by JavaScript -->
          </div>
        </div>
        <div class="video-info">
          <h2 class="video-title">The Ultimate Guide to Natural Oral Care</h2>
          <div class="video-stats">
            <span>245K views</span>
            <span>2 days ago</span>
          </div>
          <div class="video-actions">
            <button class="video-action-btn">👍 Like</button>
            <button class="video-action-btn">👎 Dislike</button>
            <button class="video-action-btn">↗️ Share</button>
            <button class="video-action-btn">💾 Save</button>
          </div>
          <div class="channel-info">
            <div class="channel-avatar"></div>
            <div>
              <div class="channel-name">HealthEssentials</div>
              <div class="channel-subscribers">1.2M subscribers</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Shop Section - NOW SHOWS REAL PRODUCTS -->
      <div class="shop-section">
        <div class="shop-header">
          <h3 class="shop-title">🔥 Trending Products from Reddit</h3>
          <a href="/shop" class="shop-view-all">View All</a>
          <button id="refresh-products" class="refresh-btn">🔄 Refresh</button>
        </div>
        <div class="product-grid" id="product-grid">
          <!-- Products will be loaded here from your API -->
          <div class="loading-spinner">Loading trending products...</div>
        </div>
      </div>
      
      <!-- Automation Stats -->
      <div class="automation-stats" id="automation-stats" style="display: none;">
        <div class="stats-header">
          <h3>💰 Automation Performance</h3>
        </div>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="total-products">0</div>
            <div class="stat-label">Products Found</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="total-profit">$0</div>
            <div class="stat-label">Profit Potential</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="top-subreddit">-</div>
            <div class="stat-label">Top Subreddit</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="last-run">Never</div>
            <div class="stat-label">Last Updated</div>
          </div>
        </div>
      </div>
      
      <!-- Recommended Videos -->
      <div class="recommended-videos">
        <div class="section-header">
          <h3 class="section-title">Recommended Videos</h3>
        </div>
        <div class="video-grid">
          <div class="video-card">
            <div class="video-card-thumbnail">
              <div class="video-card-duration">10:28</div>
            </div>
            <div class="video-card-info">
              <div class="channel-avatar-small"></div>
              <div class="video-card-details">
                <h4 class="video-card-title">5 Tips for Healthier Skin in Winter</h4>
                <div class="video-card-channel">SkinCareGuru</div>
                <div class="video-card-stats">189K views • 3 weeks ago</div>
              </div>
            </div>
          </div>
          <div class="video-card">
            <div class="video-card-thumbnail">
              <div class="video-card-duration">15:42</div>
            </div>
            <div class="video-card-info">
              <div class="channel-avatar-small"></div>
              <div class="video-card-details">
                <h4 class="video-card-title">DIY Natural Hair Treatments</h4>
                <div class="video-card-channel">OrganicBeauty</div>
                <div class="video-card-stats">87K views • 5 days ago</div>
              </div>
            </div>
          </div>
          <div class="video-card">
            <div class="video-card-thumbnail">
              <div class="video-card-duration">8:14</div>
            </div>
            <div class="video-card-info">
              <div class="channel-avatar-small"></div>
              <div class="video-card-details">
                <h4 class="video-card-title">The Truth About Commercial Toothpastes</h4>
                <div class="video-card-channel">HealthEssentials</div>
                <div class="video-card-stats">325K views • 2 months ago</div>
              </div>
            </div>
          </div>
          <div class="video-card">
            <div class="video-card-thumbnail">
              <div class="video-card-duration">12:07</div>
            </div>
            <div class="video-card-info">
              <div class="channel-avatar-small"></div>
              <div class="video-card-details">
                <h4 class="video-card-title">Morning Routine for Clearer Skin</h4>
                <div class="video-card-channel">BeautyScience</div>
                <div class="video-card-stats">152K views • 1 week ago</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay"></div>
  
  <!-- Login Modal -->
  <div id="login-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Sign In</h3>
        <button class="close-modal" onclick="closeModal('login-modal')">×</button>
      </div>
      <form class="modal-form" id="login-form">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" required>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" required>
        </div>
        <button type="submit" class="form-submit">Sign In</button>
        <div class="form-switch">
          Don't have an account? <a href="#" onclick="switchModal('login-modal', 'signup-modal')">Sign Up</a>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Signup Modal -->
  <div id="signup-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Create Account</h3>
        <button class="close-modal" onclick="closeModal('signup-modal')">×</button>
      </div>
      <form class="modal-form" id="signup-form">
        <div class="form-group">
          <label for="signup-name">Full Name</label>
          <input type="text" id="signup-name" required>
        </div>
        <div class="form-group">
          <label for="signup-email">Email</label>
          <input type="email" id="signup-email" required>
        </div>
        <div class="form-group">
          <label for="signup-password">Password</label>
          <input type="password" id="signup-password" required minlength="6">
        </div>
        <div class="form-group">
          <label for="signup-confirm">Confirm Password</label>
          <input type="password" id="signup-confirm" required minlength="6">
        </div>
        <button type="submit" class="form-submit">Create Account</button>
        <div class="form-switch">
          Already have an account? <a href="#" onclick="switchModal('signup-modal', 'login-modal')">Sign In</a>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Upload Modal -->
  <div id="upload-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Upload Video</h3>
        <button class="close-modal" onclick="closeModal('upload-modal')">×</button>
      </div>
      <form class="modal-form" id="upload-form">
        <div class="form-group">
          <label for="video-title">Title</label>
          <input type="text" id="video-title" required>
        </div>
        <div class="form-group">
          <label for="video-description">Description</label>
          <textarea id="video-description" rows="4" required></textarea>
        </div>
        <div class="form-group">
          <label for="video-file">Video File</label>
          <input type="file" id="video-file" accept="video/*" required>
        </div>
        <div class="form-group">
          <label for="thumbnail-file">Thumbnail</label>
          <input type="file" id="thumbnail-file" accept="image/*" required>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="video-publish" checked> Publish immediately
          </label>
        </div>
        <button type="submit" class="form-submit">Upload</button>
      </form>
    </div>
  </div>
  
  <!-- Scripts -->
  <script src="/js/main.js"></script>
  <script src="/js/subtle-effect.js"></script>
  
  <!-- Scripts -->
  <script src="/js/main.js"></script>
  <script src="/js/subtle-effect.js"></script>
  
  <script>
    console.log('🚀 LOADING PRODUCTS WITH REAL IMAGES NOW');
    
    fetch('/api/automation/products?limit=8')
      .then(response => {
        console.log('📡 Response status:', response.status);
        return response.json();
      })
      .then(data => {
        console.log('📦 Raw data:', data);
        
        if (data.success && data.products && data.products.length > 0) {
          const productGrid = document.getElementById('product-grid');
          console.log('🎯 Product grid found:', !!productGrid);
          console.log('🎯 Number of products:', data.products.length);
          
          const html = data.products.map((product, index) => {
            console.log(`Processing product ${index}: ${product.name}`);
            console.log(`Image URL: ${product.imageUrl}`);
            console.log(`Supplier: ${product.supplier}`);
            
            return `
              <div class="product-card">
                <div class="product-image">
                  <img src="${product.imageUrl || 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=400&h=400&fit=crop&crop=center'}" 
                       alt="${product.name}" 
                       style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px; display: block;" 
                       onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                  <div style="display:none; font-size:2rem; text-align:center; padding:50px;">🛍️</div>
                </div>
                <div class="product-info">
                  <div class="product-name" style="white-space: normal; overflow: visible; text-overflow: unset; height: auto; line-height: 1.3;">${product.name}</div>
                  <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                  <div class="product-rating">🔥 ${product.trendingScore} | r/${product.subreddit} | ${product.supplier || 'Amazon'}</div>
                </div>
              </div>
            `;
          }).join('');
          
          console.log('📝 Generated HTML length:', html.length);
          console.log('🎨 First 200 chars of HTML:', html.substring(0, 200));
          productGrid.innerHTML = html;
          console.log('✅ PRODUCTS DISPLAYED WITH REAL IMAGES');
          
          // Double check images loaded
          const images = productGrid.querySelectorAll('img');
          console.log(`🖼️ Found ${images.length} images in DOM`);
          images.forEach((img, i) => {
            console.log(`Image ${i}: ${img.src}`);
          });
          
        } else {
          console.log('❌ No products or data.success is false');
          document.getElementById('product-grid').innerHTML = '<div>No products found</div>';
        }
      })
      .catch(error => {
        console.error('💥 FETCH ERROR:', error);
        document.getElementById('product-grid').innerHTML = '<div>Error loading products</div>';
      });

    // Modal functions
    function openModal(modalId) {
      document.getElementById(modalId).style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }
    
    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
      document.body.style.overflow = 'auto';
    }
    
    function switchModal(closeId, openId) {
      closeModal(closeId);
      openModal(openId);
    }
    
    window.onclick = function(event) {
      const modals = document.getElementsByClassName('modal');
      for (let i = 0; i < modals.length; i++) {
        if (event.target === modals[i]) {
          modals[i].style.display = 'none';
          document.body.style.overflow = 'auto';
        }
      }
    };
    
    document.getElementById('upload-btn').addEventListener('click', function() {
      openModal('upload-modal');
    });
  </script>
</body>
</html>
</body>
</html>